<div class="w-full">
  <div class="relative text-gray-800">
    <label class="block text-sm font-medium text-gray-700 mb-2">{{ label() }}</label>
    <button
      (click)="toggle()"
      class="flex w-full items-center justify-between rounded-lg border border-gray-300 bg-white px-4 py-2.5 shadow-sm transition-all hover:border-gray-400 focus:outline-none"
    >
      <span class="text-sm font-medium">{{ displayLabel() }}</span>
      <svg
        class="h-4 w-4 text-gray-500 transition-transform duration-200"
        [class.rotate-180]="isOpen()"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    @if (isOpen()) {
      <div
        class="absolute z-50 mt-2 w-full rounded-xl border border-gray-100 bg-white py-2 shadow-2xl"
      >
        <div
          class="mx-3 mb-3 mt-1 flex items-center rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 focus-within:border-blue-400 focus-within:ring-1 focus-within:ring-blue-400"
        >
          <svg class="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            />
          </svg>
          <input
            type="text"
            placeholder="Search city..."
            class="ml-2 w-full bg-transparent text-sm outline-none placeholder:text-gray-400"
            [value]="searchTerm()"
            (input)="searchTerm.set($any($event.target).value)"
            (click)="$event.stopPropagation()"
          />
        </div>

        <!-- <div class="flex items-center px-4 py-2">
        <img src="https://flagcdn.com/ae.svg" alt="UAE" class="h-3.5 w-5 rounded-sm object-cover shadow-sm">
        <span class="ml-3 flex-grow text-sm font-bold text-gray-700">United Arab Emirates</span>
        <svg class="h-4 w-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
        </svg>
      </div> -->

        <ul class="max-h-60 overflow-y-auto px-3">
          @for (item of filteredItems(); track item.value) {
            <li
              (click)="select(item)"
              class="group flex cursor-pointer items-center justify-between py-2.5 pl-12 pr-4 hover:bg-blue-50 transition-colors border-b border-gray-100 last:border-0"
            >
              <span class="text-sm text-gray-600 group-hover:text-blue-700">{{ item.label }}</span>

              <div
                class="flex h-4.5 w-4.5 items-center justify-center rounded-full border-2 transition-all"
                [class.border-blue-500]="selectedItem()?.value === item.value"
                [class.border-gray-200]="selectedItem()?.value !== item.value"
              >
                @if (selectedItem()?.value === item.value) {
                  <div
                    class="h-2.5 w-2.5 rounded-full bg-blue-500 animate-in zoom-in-50 duration-200"
                  ></div>
                }
              </div>
            </li>
          } @empty {
            <li class="px-4 py-8 text-center text-sm text-gray-400">
              No results found for "{{ searchTerm() }}"
            </li>
          }
        </ul>
      </div>
    }
  </div>
</div>

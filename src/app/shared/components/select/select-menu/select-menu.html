<div class="min-w-[232.57px]">
  <div class="flex flex-col gap-1.5 font-sans min-w-[232.57px]">
    @if (label()) {
      <label [for]="uniqueId" class="block text-sm font-medium text-slate-700 ml-0.5">
        {{ label() }}
      </label>
    }

    <div class="relative">
      <!-- Trigger -->
      <button
        [id]="uniqueId"
        (click)="toggleDropdown()"
        type="button"
        class="flex w-full items-center justify-between rounded-lg border border-slate-300 bg-white px-4 py-2.5 text-left text-sm text-slate-900 shadow-sm ring-offset-2 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500/20"
      >
        @if (selectedOptions().length === 0) {
          <span class="text-slate-400">{{ placeholder() }}</span>
        }

        @for (option of selectedOptions(); track option.id) {
          <span
            class="flex items-center gap-1 rounded-md bg-gray-100 px-2 py-1 text-xs text-black-700"
          >
            {{ option.label }}
            <button
              type="button"
              (click)="removeOption(option); $event.stopPropagation()"
              class="text-black-600 hover:text-blue-800"
            >
              ✕
            </button>
          </span>
        }

        <span class="ml-auto">
          <svg
            class="h-4 w-4 text-slate-500 transition-transform duration-200"
            [class.rotate-180]="isOpen()"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
              clip-rule="evenodd"
            />
          </svg>
        </span>
      </button>

      <!-- Dropdown -->
      @if (isOpen()) {
        <div
          class="absolute z-50 mt-2 rounded-xl border border-slate-200 bg-white  shadow-xl animate-in fade-in slide-in-from-top-1 duration-150"
        >
          <div class="flex flex-row p-3 w-full gap-2 max-h-60 overflow-y-auto">
            @for (option of options(); track option.id) {
              <button
                type="button"
                (click)="toggleOption(option)"
                class="flex items-center gap-2 rounded-md border px-1 py-0.5 text-sm transition-all active:scale-[0.97]"
                [class.border-blue-400]="isSelected(option)"
                [class.bg-white-50]="isSelected(option)"
                [class.text-black-700]="isSelected(option)"
                [class.border-slate-200]="!isSelected(option)"
                [class.text-slate-600]="!isSelected(option)"
                [class.hover:bg-blue-50]="!isSelected(option)"
              >
                {{ option.label }}
                <!-- @if (isSelected(option)) {
                  <span class="text-xs font-medium">✔</span>
                } -->
              </button>
            }
          </div>
        </div>
      }
    </div>
  </div>
</div>
